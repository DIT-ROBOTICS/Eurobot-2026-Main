<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4">
    <!-- Main Behavior Tree for Eurobot 2026 -->
    <BehaviorTree ID="MainTree">
        <Sequence>
            <!-- Initialize receivers -->
            <CamReceiver/>
            <LocReceiver/>
            <FieldUpdater/>  
            <!-- Main mission loop with timeout -->
            <Parallel failure_count="2" success_count="1">
                <Repeat num_cycles="-1">
                    <Sequence>
                        <!-- Get next target from DecisionCore -->
                        <DecisionCore 
                            next_target_index="{target_index}"
                            next_target_pose="{target_pose}"
                            action_type="{action_type}"/>
                        
                        <!-- Navigate to target -->
                        <NavigationActionNode
                            goal="{target_pose}"
                            dock_type="dock_y_loose_linearBoost"
                            finish_pose="{nav_result_pose}"/>
                    </Sequence>
                </Repeat>
                <Sleep msec="100000"/>  <!-- 100 seconds timeout -->
            </Parallel>
            
            <!-- Stop robot when done -->
            <StopRobotNode/>
        </Sequence>
    </BehaviorTree>

    <!-- Navigation subtree -->
    <BehaviorTree ID="NavigationSubTree">
        <Sequence>
            <NavigationActionNode
                goal="{nav_goal}"
                dock_type="dock_y_loose_linearBoost"
                finish_pose="{nav_result}"/>
        </Sequence>
    </BehaviorTree>
</root>
