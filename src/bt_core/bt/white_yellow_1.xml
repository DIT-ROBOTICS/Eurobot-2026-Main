<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4">
    <!-- Main Behavior Tree for Eurobot 2026 -->
    <BehaviorTree ID="MainTree">
        <Sequence>
            <!-- Initialize receivers -->
            <CamReceiver/>
            
            <!-- Main mission loop -->
            <Repeat num_cycles="-1">
                <Sequence>
                    <!-- Get next target from DecisionCore -->
                    <DecisionCore 
                        next_target_index="{target_index}"
                        next_target_pose="{target_pose}"
                        action_type="{action_type}"/>
                    
                    <!-- Navigate to target -->
                    <NavigationActionNode
                        goal="{target_pose}"
                        dock_type="front"
                        final_pose="{nav_result_pose}"/>
                    
                    <!-- Precise docking at target -->
                    <Docking
                        base="{nav_result_pose}"
                        offset="0.1"
                        shift="0.0"
                        dock_type="front"
                        isPureDocking="true"
                        final_pose="{dock_result_pose}"/>
                </Sequence>
            </Repeat>
            
            <!-- Stop robot when done -->
            <StopRobotNode/>
        </Sequence>
    </BehaviorTree>

    <!-- Docking subtree for precise positioning -->
    <BehaviorTree ID="DockingSubTree">
        <Sequence>
            <Docking
                base="{dock_target}"
                offset="{dock_offset}"
                shift="{dock_shift}"
                dock_type="{dock_type}"
                isPureDocking="true"
                final_pose="{dock_result}"/>
        </Sequence>
    </BehaviorTree>

    <!-- Navigation subtree -->
    <BehaviorTree ID="NavigationSubTree">
        <Sequence>
            <NavigationActionNode
                goal="{nav_goal}"
                dock_type="front"
                final_pose="{nav_result}"/>
        </Sequence>
    </BehaviorTree>
</root>
